scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = "none",
plot.title = element_text(size = 11, face = "bold", hjust = 0.5)
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel)) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 0.9) +
scale_fill_viridis(discrete = TRUE, alpha = 0.6) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = "none",
plot.title = element_text(size = 11, face = "bold", hjust = 0.5)
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel)) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = "none",
plot.title = element_text(size = 11, face = "bold", hjust = 0.5)
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = "none",
plot.title = element_text(size = 11, face = "bold", hjust = 0.5)
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(electric, aes(x =Fuel, y =Combined)) +
#geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = "none",
plot.title = element_text(size = 11, face = "bold", hjust = 0.5)
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = "none",
plot.title = element_text(size = 11, face = "bold", hjust = 0.5)
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(fossil, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha = 0.2) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 0.9) +
scale_fill_viridis(discrete = TRUE, alpha = 0.6) +
scale_color_manual(values = c("G" = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_fill_manual(values = c('G' = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_x_discrete(labels = c("G" = "Gasolina 95", "D" = "Diesel",
'H_F'='Híbrido parte Combustível Fóssil',
'PG'='Gasolina 98')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_ipsum() +
theme(
legend.position = "none",
plot.title = element_text(size = 11, face = "bold", hjust = 0.5)
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = 'none'
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = 'none',
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = 'none',
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(fossil, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha = 0.2) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 0.9) +
scale_fill_viridis(discrete = TRUE, alpha = 0.6) +
scale_color_manual(values = c("G" = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_fill_manual(values = c('G' = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_x_discrete(labels = c("G" = "Gasolina 95", "D" = "Diesel",
'H_F'='Híbrido parte Combustível Fóssil',
'PG'='Gasolina 98')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_ipsum() +
theme(
legend.position = "none",
plot.title = element_text(size = 11, face = "bold", hjust = 0.5)
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(fossil, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha = 0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 0.9) +
scale_fill_viridis(discrete = TRUE, alpha = 0.6) +
scale_color_manual(values = c("G" = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_fill_manual(values = c('G' = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_x_discrete(labels = c("G" = "Gasolina 95", "D" = "Diesel",
'H_F'='Híbrido parte Combustível Fóssil',
'PG'='Gasolina 98')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_ipsum() +
theme(
legend.position = "none",
plot.title = element_text(size = 11, face = "bold", hjust = 0.5)
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(fossil, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha = 0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 0.9) +
scale_fill_viridis(discrete = TRUE, alpha = 0.6) +
scale_color_manual(values = c("G" = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_fill_manual(values = c('G' = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_x_discrete(labels = c("G" = "Gasolina 95", "D" = "Diesel",
'H_F'='Híbrido parte Combustível Fóssil',
'PG'='Gasolina 98')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = 'none',
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = 'none',
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
box_fossil <- ggplot(fossil, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha = 0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 0.9) +
scale_fill_viridis(discrete = TRUE, alpha = 0.6) +
scale_color_manual(values = c("G" = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_fill_manual(values = c('G' = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_x_discrete(labels = c("G" = "Gasolina 95", "D" = "Diesel",
'H_F'='Híbrido parte Combustível Fóssil',
'PG'='Gasolina 98')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = 'none',
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
box_elextric <- ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = 'none',
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
box_electric <- ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a cada 100 km") +
theme_minimal() +
theme(
legend.position = 'none',
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
box_fossil + box_electric
library(patchwork)
box_fossil + box_electric
box_fossil <- ggplot(fossil, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha = 0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 0.9) +
scale_fill_viridis(discrete = TRUE, alpha = 0.6) +
scale_color_manual(values = c("G" = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_fill_manual(values = c('G' = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_x_discrete(labels = c("G" = "Gasolina 95", "D" = "Diesel",
'H_F'='Híbrido parte Combustível Fóssil',
'PG'='Gasolina 98')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a Litros/100 km") +
theme_minimal() +
theme(
legend.position = 'none',
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
box_electric <- ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a kWh/100 km") +
theme_minimal() +
theme(
legend.position = 'none',
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
ggtitle("Consumo Combinado do Carro vs Tipo de Combustível")
library(patchwork)
box_fossil + box_electric
box_fossil <- ggplot(fossil, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha = 0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 0.9) +
scale_fill_viridis(discrete = TRUE, alpha = 0.6) +
scale_color_manual(values = c("G" = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_fill_manual(values = c('G' = gas_color, "D" = diesel_color,
'PG'=pgas_color,'H_F'= fhybrid_color)) +
scale_x_discrete(labels = c("G" = "Gasolina 95", "D" = "Diesel",
'H_F'='Híbrido parte Combustível Fóssil',
'PG'='Gasolina 98')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a Litros/100 km",
title = "Consumo Combinado do Combustível Fóssil vs Tipo de Combustível") +
theme_minimal() +
theme(
legend.position = 'none',
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
)
box_electric <- ggplot(electric, aes(x =Fuel, y =Combined)) +
geom_boxplot(aes(fill =Fuel), alpha=0.3) +
geom_jitter(aes(color =Fuel), size = 0.3, alpha = 1) +
scale_fill_viridis(discrete = TRUE, alpha = 1) +
scale_color_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_fill_manual(values = c("H_E" = ehybrid_color,'E'=e_color)) +
scale_x_discrete(labels = c("H_E" = "Híbrido parte Elétrico", 'E'='Elétrico')) +
labs(x = "Tipo de Combustível", y = "Consumo Combinado a kWh/100 km",
title = "Consumo Combinado dos Carros Elétricos vs Tipo de Combustível") +
theme_minimal() +
theme(
legend.position = 'none',
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
)
library(patchwork)
box_fossil + box_electric
gas <- PT_all[PT_all$'Fuel Type'=='G',]
diesel <- PT_all[PT_all$'Fuel Type'=='D',]
hybrids <- PT_all[PT_all$'Fuel Type'=='H',]
cor(gas$`Engine Capacity (cm3)`,gas$`Test Emission CO2 (g/km)`)
cor(diesel$`Engine Capacity (cm3)`,diesel$`Test Emission CO2 (g/km)`)
cor(hybrids$`Engine Capacity (cm3)`,hybrids$`Test Emission CO2 (g/km)`)
gasoline_co2 <- ggplot(gas, aes(x=`Engine Capacity (cm3)`,
y=`Test Emission CO2 (g/km)`))+
geom_point(color=cores[3]) +
geom_smooth(method=lm, se=FALSE) +
labs(title = 'Cilindradas de Carros a Gasolina vs Emissão CO2',
x = 'Cilindradas', y = 'Emissão de CO2') +
theme_ipsum() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5)
)
cores <- c(rgb(245,140,76,maxColorValue = 255), #diesel
rgb(120,200,250, maxColorValue = 255), #eletrico
rgb(245,191,76,maxColorValue = 255), #gasolina
rgb(12,124,250,maxColorValue = 255)) #hibrido
lista_dfs <- list() #lista para guardar dataframes
PT_year <- c(2018,2019,2020,2021,2022)
PT_data <- c('PT_2018','PT_2019','PT_2020','PT_2021','PT_2022')
cores <- c(rgb(245,140,76,maxColorValue = 255), #diesel
rgb(120,200,250, maxColorValue = 255), #eletrico
rgb(245,191,76,maxColorValue = 255), #gasolina
rgb(12,124,250,maxColorValue = 255)) #hibrido
for (df_name in PT_data) {
get_df <- get(df_name) #puxa o dataframe
fuels_type <- names(table(get_df$"Fuel Type")); #pega os tipos de combustíveis
dados_ano <- as.data.frame(table(get_df$`Fuel Type`)); #pega a quantidade de carros com aquele combustível no ano
# Adiciona uma coluna com o ano de acontecimento
dados_ano$Ano <- as.numeric(substring(df_name, 4, 7))  # Extrai o ano do nome do dataframe
# Adiciona o dataframe à lista
lista_dfs[[df_name]] <- dados_ano
}
# Concatena os dataframes da lista
df1 <- do.call(rbind, lista_dfs) #junta todas as linhas feitas pelo 'for'
year_mean_CO2 <- tapply(PT_all$`Test Emission CO2 (g/km)`,
PT_all$Year, mean) #faz a média da emissão co2 por ano
years <- names(year_mean_CO2)
df2 <- data.frame(Ano = years,Media_CO2 = year_mean_CO2) #cria um dataframe com as colunas ano e media_co2
df_completo <- merge(df1, df2, by = "Ano", fill = NA); head(df_completo) #junta os dataframes por coluna agrupando por ano
ggplot(df_completo) +
geom_bar(aes(x = Ano, y = Freq/1000, fill = Var1),
stat = 'identity', position = 'dodge') +
geom_line(aes(x = Ano, y = Media_CO2, colour = 'Média Emissão de CO2'),  # Change color to cyan
stat = "identity", size = 0.5) +
geom_point(aes(x = Ano, y = Media_CO2), color='red',size=2) +
geom_text(aes(x = Ano, y = Media_CO2, label = round(Media_CO2,2)),
nudge_y = 5) +
labs(title = 'Frequência de Carros por Combustível vs Emissão de CO2 por Ano',
x = 'Ano', y = 'Frequência de Carros em Circulação a Cada Mil Carros') +
theme_ipsum() +
theme(
legend.position = "right",
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
scale_fill_manual(values = c(D=cores[1], E=cores[2], G=cores[3], H=cores[4]),
labels = c(D='Diesel', E='Elétrico', G='Gasolina', H='Híbrido'),
name = "Combustível") +
guides(color = guide_legend(title = "CO2"))  # Add legend for the line
gas <- PT_all[PT_all$'Fuel Type'=='G',]
diesel <- PT_all[PT_all$'Fuel Type'=='D',]
hybrids <- PT_all[PT_all$'Fuel Type'=='H',]
cor(gas$`Engine Capacity (cm3)`,gas$`Test Emission CO2 (g/km)`)
cor(diesel$`Engine Capacity (cm3)`,diesel$`Test Emission CO2 (g/km)`)
cor(hybrids$`Engine Capacity (cm3)`,hybrids$`Test Emission CO2 (g/km)`)
gasoline_co2 <- ggplot(gas, aes(x=`Engine Capacity (cm3)`,
y=`Test Emission CO2 (g/km)`))+
geom_point(color=cores[3]) +
geom_smooth(method=lm, se=FALSE) +
labs(title = 'Cilindradas de Carros a Gasolina vs Emissão CO2',
x = 'Cilindradas', y = 'Emissão de CO2') +
theme_ipsum() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5)
)
diesel_co2 <- ggplot(diesel, aes(x=`Engine Capacity (cm3)`,
y=`Test Emission CO2 (g/km)`))+
geom_point(color=cores[1])+
geom_smooth(method=lm, se=FALSE)+
labs(title = 'Cilindradas de Carros a Diesel vs Emissão CO2',
x = 'Cilindradas', y = 'Emissão de CO2') +
theme_ipsum() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5)
)
hybrid_co2 <- ggplot(hybrids, aes(x=`Engine Capacity (cm3)`,
y=`Test Emission CO2 (g/km)`))+
geom_point(color=cores[4])+
geom_smooth(method=lm, se=FALSE)+
labs(title = 'Cilindradas de Carros Híbridos vs Emissão CO2',
x = 'Cilindradas', y = 'Emissão de CO2') +
theme_ipsum() +
theme(
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5)
)
library(patchwork)
gasoline_co2 / diesel_co2 / hybrid_co2
PT_data <- c('PT_2018','PT_2019','PT_2020','PT_2021','PT_2022')
lista_dfs <- list() #lista para guardar dataframes
for (df_name in PT_data) {
get_df <- get(df_name)
fuels_type <- names(table(get_df$"Fuel Type"))
cores <- c(rgb(245,140,76,maxColorValue = 255), #diesel
rgb(120,200,250, maxColorValue = 255), #eletrico
rgb(245,191,76,maxColorValue = 255), #gasolina
rgb(12,124,250,maxColorValue = 255)) #hibrido
df <- as.data.frame(table(get_df$`Fuel Type`))
# Adiciona uma coluna com o ano de acontecimento
df$Ano <- as.numeric(substring(df_name, 4, 7))  # Extrai o ano do nome do dataframe
# Adiciona o dataframe à lista
lista_dfs[[df_name]] <- df
}
# Concatena os dataframes da lista
df_concatenado <- do.call(rbind, lista_dfs); df_concatenado
ggplot(df_concatenado, aes(x = factor(Ano), y = Freq, fill = Var1)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Frequência de Carros pelo Combustível por Ano",
x = "Ano", y = "Frequência de Carros em Circulação") +
theme_ipsum() +
theme(
legend.position = "right",
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
axis.title.x = element_text(size = 12, hjust = 0.5),
axis.title.y = element_text(size = 12, hjust = 0.5),
legend.title = element_text(size = 11, face = "bold")
) +
scale_fill_manual(values = c(D=cores[1], E=cores[2], G=cores[3], H=cores[4]),
labels = c(D='Diesel', E='Elétrico', G='Gasolina', H='Híbrido'),
name = "Combustível")
