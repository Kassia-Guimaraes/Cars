novo_dataframe$Freq <- round(dados$media_CO2, 2); novo_dataframe
novo_dataframe$Freq <- rbind(df$Freq); novo_dataframe
novo_dataframe <- data.frame(Freq = numeric(nrow(dados)+nrow(df)),
Var1 = numeric(nrow(dados)+nrow(df)),
Ano = numeric(nrow(dados)+nrow(df))); novo_dataframe
novo_dataframe$Freq <- round(dados$media_CO2, 2); novo_dataframe
novo_dataframe$Freq <- (df$Freq); novo_dataframe
novo_dataframe <- data.frame(Freq = numeric(nrow(dados)+nrow(df)),
Var1 = numeric(nrow(dados)+nrow(df)),
Ano = numeric(nrow(dados)+nrow(df))); novo_dataframe
novo_dataframe$Freq <- round(dados$media_CO2, 2); novo_dataframe
novo_dataframe$Freq <- (df$Freq); novo_dataframe
novo_dataframe$Freq <- c((df$Freq),round(dados$media_CO2, 2)); novo_dataframe
nrow(dados)
novo_dataframe$Var1 <- c(df$Var1,rep('Media CO2',5)); novo_dataframe
novo_dataframe$Freq <- c((df$Freq),round(dados$media_CO2, 2)); novo_dataframe
novo_dataframe$Var1 <- c(rep('E',5),rep('Media CO2',5)); novo_dataframe
novo_dataframe <- data.frame(Freq = numeric(nrow(dados)+nrow(df)),
Var1 = numeric(nrow(dados)+nrow(df)),
Ano = numeric(nrow(dados)+nrow(df))); novo_dataframe
novo_dataframe$Freq <- c((df$Freq),round(dados$media_CO2, 2)); novo_dataframe
novo_dataframe$Var1 <- c(rep('E',5),rep('Media CO2',5)); novo_dataframe
novo_dataframe$Ano <- df$Ano
novo_dataframe$Ano <- df$Ano; novo_dataframe
eletric_CO2 <- data.frame(Freq = numeric(nrow(dados)+nrow(df)),
Var1 = numeric(nrow(dados)+nrow(df)),
Ano = numeric(nrow(dados)+nrow(df))); eletric_CO2
eletric_CO2 <- c((df$Freq),round(dados$media_CO2, 2)); eletric_CO2
eletric_CO2 <- c(rep('E',5),rep('Media CO2',5)); eletric_CO2
eletric_CO2 <- df$Ano; eletric_CO2
eletric_CO2 <- data.frame(Freq = numeric(nrow(dados)+nrow(df)),
Var1 = numeric(nrow(dados)+nrow(df)),
Ano = numeric(nrow(dados)+nrow(df))); eletric_CO2
eletric_CO2 <- c((df$Freq),round(dados$media_CO2, 2)); eletric_CO2
eletric_CO2 <- c(rep('E',5),rep('Media CO2',5)); eletric_CO2
eletric_CO2 <- df$Ano; eletric_CO2
ggplot(df, aes(x = factor(Ano), y = Freq, group=1, label=Freq, fill=Var1)) +
geom_line(color=rgb(120,200,250, maxColorValue = 255)) +
geom_point(color='blue') +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = df$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
eletric_CO2 <- data.frame(Freq = numeric(nrow(dados)+nrow(df)),
Var1 = numeric(nrow(dados)+nrow(df)),
Ano = numeric(nrow(dados)+nrow(df))); eletric_CO2
eletric_CO2 <- c((df$Freq),round(dados$media_CO2, 2)); eletric_CO2
eletric_CO2 <- c(rep('E',5),rep('Media CO2',5)); eletric_CO2
eletric_CO2 <- df$Ano; novo_dataframe
eletric_CO2 <- data.frame(Freq = numeric(nrow(dados)+nrow(df)),
Var1 = numeric(nrow(dados)+nrow(df)),
Ano = numeric(nrow(dados)+nrow(df))); eletric_CO2
eletric_CO2$Freq <- c((df$Freq),round(dados$media_CO2, 2)); eletric_CO2
eletric_CO2$Var1 <- c(rep('E',5),rep('Media CO2',5)); eletric_CO2
eletric_CO2$Ano <- df$Ano; novo_dataframe
ggplot(df, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(color=rgb(120,200,250, maxColorValue = 255)) +
geom_point(color='blue') +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = df$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(color=rgb(120,200,250, maxColorValue = 255)) +
geom_point(color='blue') +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = df$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(color=rgb(120,200,250, maxColorValue = 255)) +
geom_point(color=Var1) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = df$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(color=rgb(120,200,250, maxColorValue = 255)) +
geom_point(color=Var1) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = df$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
eletric_CO2$Var1 <- c(rep('E',5),rep('Media CO2',5)); eletric_CO2
eletric_CO2$Ano <- df$Ano; novo_dataframe
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(color=rgb(120,200,250, maxColorValue = 255)) +
geom_point(color=Var1) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = df$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(color=Var1) +
geom_point() +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = df$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(color=aes(Var1)) +
geom_point() +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = df$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point() +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = df$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point() +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(color = c('red','blue')) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(color=c('red','blue')) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=c('red','blue'))) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color = c('blue', 'red'))) + # Cores fixas
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group = Var1, label = Freq)) +
geom_point(aes(color = Var1)) + # Map color to Var1 using color scale (default)
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação") +
geom_text(nudge_y = 10)
cores_fixas <- c("red", "green", "blue", "purple", "orange",
"black", "grey", "yellow", "pink", "teal")
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group = Var1, label = Freq)) +
geom_point(aes(color = cores_fixas[1:10])) + # Use the first 10 elements of the color vector
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação") +
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color = c('blue', 'red'))) + # Cores fixas
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group = Var1, label = Freq)) +
geom_point(aes(color = Var1)) + # Map color to Var1 using color scale (default)
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação") +
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
eletric_CO2 <- data.frame(Freq = numeric(nrow(dados)+nrow(df)),
Var1 = numeric(nrow(dados)+nrow(df)),
Ano = numeric(nrow(dados)+nrow(df)),
Cor = numeric(nrow(dados)+nrow(df))); eletric_CO2
eletric_CO2$Freq <- c((df$Freq),round(dados$media_CO2, 2)); eletric_CO2
eletric_CO2$Var1 <- c(rep('E',5),rep('Media CO2',5)); eletric_CO2
eletric_CO2$Ano <- df$Ano; eletric_CO2
eletric_CO2$Cor <- c(rep(rgb(120,200,250, maxColorValue = 255),5),
rep(rgb(245,140,76,maxColorValue = 255),5)); eletric_CO2
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Cor)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Cor)) +
geom_point(aes(color=Cor)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = df_concatenado$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = eletric_CO2, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = eletric_CO2, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = eletric_CO2$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)+
scale_fill_manual(values = eletric_CO2$Var1, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
ggplot(dados, aes(x = ano, y = media_CO2, group=1,label=round(media_CO2,2))) +
geom_line(color =rgb(245,140,76,maxColorValue = 255)) +
geom_point(color = 'orange') +
labs(title = "Emissão média anual de CO2",
x = "Ano",
y = "Emissão média de CO2 (g/km)")+
geom_text(nudge_y = 2)
table(PT_all$"Fuel Type")
PT_year <- c(2018,2019,2020,2021,2022)
PT_data <- c('PT_2018','PT_2019','PT_2020','PT_2021','PT_2022')
for (df_name in PT_data){
df <- get(df_name)
max_brand <- max(table(df$Make))
min_brand <- min(table(df$Make))
name_max <- names(table(df$Make))[table(df$Make) == max_brand] #carros que mais entraram em circulação
name_min <- names(table(df$Make))[table(df$Make) == min_brand] #carros que menos entraram em circulação
cat(df_name,'\nMAX:', name_max,max_brand,'\nMIN: ',name_min,min_brand,'\n\n')
}
for (df_name in PT_data){
df <- get(df_name)
max_model <- max(table(df$Model))
name_max <- names(table(df$Model))[table(df$Model) == max_model]
cat(df_name,'\nMAX:', name_max,max_model,'\n\n\n')
}
more_polution_2018 <- PT_2018[which.max(PT_2018$'Test Emission CO2 (g/km)'),]
more_polution_2019 <- PT_2019[which.max(PT_2019$'Test Emission CO2 (g/km)'),]
more_polution_2020 <- PT_2020[which.max(PT_2020$'Test Emission CO2 (g/km)'),]
more_polution_2021 <- PT_2021[which.max(PT_2021$'Test Emission CO2 (g/km)'),]
more_polution_2022 <- PT_2022[which.max(PT_2022$'Test Emission CO2 (g/km)'),]
more_polution <- rbind(more_polution_2018, more_polution_2019, more_polution_2020, more_polution_2021, more_polution_2022)
PT_2018_without_E <- PT_2018[PT_2018$"Fuel Type" != "E",]
PT_2019_without_E <- PT_2019[PT_2019$"Fuel Type" != "E",]
PT_2020_without_E <- PT_2020[PT_2020$"Fuel Type" != "E",]
PT_2021_without_E <- PT_2021[PT_2021$"Fuel Type" != "E",]
PT_2022_without_E <- PT_2022[PT_2022$"Fuel Type" != "E",]
PT_all_without_E <- PT_all[PT_all$`Fuel Type` != 'E',]
less_polution_2018 <- PT_2018_without_E[which.min(PT_2018_without_E$'Test Emission CO2 (g/km)'),]
less_polution_2019 <- PT_2019_without_E[which.min(PT_2019_without_E$'Test Emission CO2 (g/km)'),]
less_polution_2020 <- PT_2020_without_E[which.min(PT_2020_without_E$'Test Emission CO2 (g/km)'),]
less_polution_2021 <- PT_2021_without_E[which.min(PT_2021_without_E$'Test Emission CO2 (g/km)'),]
less_polution_2022 <- PT_2022_without_E[which.min(PT_2022_without_E$'Test Emission CO2 (g/km)'),]
less_polution <- rbind(less_polution_2018, less_polution_2019, less_polution_2020, less_polution_2021, less_polution_2022)
lista_dfs <- list() #lista para guardar dataframes
for (df_name in PT_data) {
get_df <- get(df_name)
fuels_type <- names(table(get_df$"Fuel Type"))
cores <- c(rgb(245,140,76,maxColorValue = 255), #diesel
rgb(120,200,250, maxColorValue = 255), #eletrico
rgb(245,191,76,maxColorValue = 255), #gasolina
rgb(12,124,250,maxColorValue = 255)) #hibrido
df <- as.data.frame(table(get_df$`Fuel Type`))
df_cores <- data.frame(Fuel_type = fuels_type, Cor = cores)
df <- merge(df, df_cores, by.x = "Var1", by.y = "Fuel_type", all.x = TRUE)
# Adiciona uma coluna com o ano de acontecimento
df$Ano <- as.numeric(substring(df_name, 4, 7))  # Extrai o ano do nome do dataframe
# Adiciona o dataframe à lista
lista_dfs[[df_name]] <- df
}
# Concatena os dataframes da lista
df_concatenado <- do.call(rbind, lista_dfs); df_concatenado
ggplot(df_concatenado, aes(x = factor(Ano), y = Freq, fill = Var1)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Frequência de Combustíveis por Ano",
x = "Ano", y = "Frequência") +
scale_fill_manual(values = df_concatenado$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(PT_all_without_E, aes(x=`Engine Capacity (cm3)`,
y=`Test Emission CO2 (g/km)`))+
geom_point()+
geom_smooth(method=lm, se=FALSE)
year_mean_CO2 <- tapply(PT_all$`Test Emission CO2 (g/km)`,
PT_all$Year, mean); year_mean_CO2
year_mean_CO2 <- tapply(PT_all$`Test Emission CO2 (g/km)`,
PT_all$Year, mean); year_mean_CO2
years <- names(year_mean_CO2); years
dados <- data.frame(ano = years, media_CO2 = year_mean_CO2); dados
df <- df_concatenado[df_concatenado$Var1=='E',]; df #pegando a quantidade dos carros elétricos de cada ano
df <- mutate(df, Freq = Freq/100); df #dividindo por 100 para conseguir fazer a correlação carros e co2
df_novo <- data.frame()
df_novo <- cbind('Var1', 'Freq', 'Year'); df_novo
df_novo$Freq <- rbind(c(df$Freq, dados$media_CO2)); df_novo
eletric_CO2 <- data.frame(Freq = numeric(nrow(dados)+nrow(df)),
Var1 = numeric(nrow(dados)+nrow(df)),
Ano = numeric(nrow(dados)+nrow(df)),
Cor = numeric(nrow(dados)+nrow(df))); eletric_CO2
eletric_CO2$Freq <- c((df$Freq),round(dados$media_CO2, 2)); eletric_CO2
eletric_CO2$Var1 <- c(rep('E',5),rep('Media CO2',5)); eletric_CO2
eletric_CO2$Ano <- df$Ano; eletric_CO2
eletric_CO2$Cor <- c(rep(rgb(120,200,250, maxColorValue = 255),5),
rep(rgb(245,140,76,maxColorValue = 255),5)); eletric_CO2
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
df_novo <- data.frame()
df_novo <- cbind('Var1', 'Freq', 'Year'); df_novo
df_novo$Freq <- rbind(c(df$Freq, dados$media_CO2)); df_novo
ggplot(eletric_CO2, aes(x = factor(Ano), y = Freq, group=Var1, label=Freq, fill=Var1)) +
geom_line(aes(color=Var1)) +
geom_point(aes(color=Var1)) +
labs(title = "Frequência de Carros Elétricos por Ano",
x = "Ano",
y = "Carros em circulação")+
geom_text(nudge_y = 10)
make_mean_CO2 <- tapply(PT_all_without_E$"Test Emission CO2 (g/km)", PT_all_without_E$Make, mean)
make_mean_CO2 <- sort(make_mean_CO2, decreasing = TRUE)
Make <- names(make_mean_CO2)[1:10]
make_more_polution <- data.frame(Make, mean_CO2 = make_mean_CO2[1:10])
max_make <- names(make_mean_CO2)[which.max(make_mean_CO2)]
make_more_polution$Is_Max <- ifelse(make_more_polution$Make == max_make, "Max", "Not Max")
color1 <- rgb(245,140,76,maxColorValue = 255)
color2 <- rgb(245,191,76,maxColorValue = 255)
make_more_polution$Color <- ifelse(make_more_polution$Is_Max == "Max", color1, color2)
ggplot(make_more_polution, aes(x = Make, y = mean_CO2, fill = Is_Max)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = c("Max" = color1, "Not Max" = color2)) +
labs(title = "10 Marcas com maior Média de Emissão de CO2",
x = "Marcas",
y = "Média de CO2 (g/km)") +
guides(fill=FALSE) +
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 16, lineheight = 1.2, margin = margin(b = 20)))
PT_all_without_E <- PT_all[PT_all$"Fuel Type" != "E",]
make_mean_CO2 <- tapply(PT_all_without_E$"Test Emission CO2 (g/km)", PT_all_without_E$Make, mean)
make_mean_CO2 <- sort(make_mean_CO2, decreasing = FALSE)
Make <- names(make_mean_CO2)[1:10]
make_less_polution <- data.frame(Make, mean_CO2 = make_mean_CO2[1:10])
less_make <- names(make_mean_CO2)[which.min(make_mean_CO2)]
make_less_polution$Is_Min <- ifelse(make_less_polution$Make == less_make, "Min", "Not Min")
color1 <- rgb(12,124,250,maxColorValue = 255)
color2 <- rgb(120,200,250, maxColorValue = 255)
make_less_polution$Color <- ifelse(make_less_polution$Is_Min == "Min", color1, color2)
ggplot(make_less_polution, aes(x = Make, y = mean_CO2, fill = Is_Min)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = c("Min" = color1, "Not Min" = color2)) +
labs(title = "10 Marcas com menor Média de Emissão de CO2",
x = "Marcas",
y = "Média de CO2 (g/km)") +
guides(fill=FALSE) +
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 16, lineheight = 1.2, margin = margin(b = 20)))
PT_all_without_E$`Fuel Type` = with(PT_all_without_E, reorder(`Fuel Type`, `Test Emission CO2 (g/km)`, median))
color1 <- rgb(245,140,76,maxColorValue = 255)
color2 <- rgb(245,191,76,maxColorValue = 255)
color3 <- rgb(12,124,250,maxColorValue = 255)
ggplot(PT_all_without_E, aes(x =`Fuel Type`, y =`Test Emission CO2 (g/km)`)) +
geom_boxplot(aes(fill =`Fuel Type`)) +
geom_jitter(aes(color =`Fuel Type`), size = 0.3, alpha = 0.9) +
scale_fill_viridis(discrete = TRUE, alpha = 0.6) +
scale_color_manual(values = c("G" = color2, "D" = color1, "H" = color3)) + # Definir as cores para cada tipo de combustível
scale_x_discrete(labels = c("G" = "Gasolina", "D" = "Diesel", "H" = "Híbrido")) + # Alterar o nome das categorias
labs(x = "Tipo de Combustível", y = "Emissões de CO2 (g/km)") +
theme_ipsum() +
theme(
legend.position = "none",
plot.title = element_text(size = 11, face = "bold", hjust = 0.5)
) +
ggtitle("Emissões de CO2 (g/km) por tipo de Combustível")
ggplot(df_concatenado, aes(x = factor(Ano), y = Freq, fill = Var1)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Frequência de Combustíveis por Ano",
x = "Ano", y = "Frequência") +
scale_fill_manual(values = df_concatenado$Cor, name = "Combustível") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(df_concatenado, aes(x = factor(Ano), y = Freq, fill = Var1)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Frequência de Combustíveis por Ano",
x = "Ano", y = "Frequência") +
scale_fill_manual(values = df_concatenado$Cor, name = "Combustível")
cores[2]
ggplot(df_concatenado, aes(x = factor(Ano), y = Freq, fill = Var1)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Frequência de Combustíveis por Ano",
x = "Ano", y = "Frequência") +
#scale_fill_manual(values = df_concatenado$Cor, name = "Combustível")+
scale_color_manual(values = c("G" = cores[3], "D" = cores[1], "H" = cores[4], 'E'=cores[2]))
ggplot(df_concatenado, aes(x = factor(Ano), y = Freq, fill = Var1)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Frequência de Combustíveis por Ano",
x = "Ano", y = "Frequência") +
scale_fill_manual(values = df_concatenado$Cor, name = "Combustível")
gas <- PT_all[PT_all$'Fuel Type'=='G',]
diesel <- PT_all[PT_all$'Fuel Type'=='D',]
hybrids <- PT_all[PT_all$'Fuel Type'=='H',]
ggplot(gas, aes(x=`Engine Capacity (cm3)`,
y=`Test Emission CO2 (g/km)`))+
geom_point()+
geom_smooth(method=lm, se=FALSE)
View(gas)
View(gas)
View(gas)
ggplot(hybrids, aes(x=`Engine Capacity (cm3)`,
y=`Test Emission CO2 (g/km)`))+
geom_point()+
geom_smooth(method=lm, se=FALSE)
ggplot(diesel, aes(x=`Engine Capacity (cm3)`,
y=`Test Emission CO2 (g/km)`))+
geom_point()+
geom_smooth(method=lm, se=FALSE)
